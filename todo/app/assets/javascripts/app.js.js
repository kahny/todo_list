// Generated by CoffeeScript 1.8.0
var TodoApp;

TodoApp = angular.module("TodoApp", ["ngRoute", "templates"]);

TodoApp.config([
  "$routeProvider", "$locationProvider", function($routeProvider, $locationProvider) {
    $routeProvider.when('/', {
      templateUrl: "index.html",
      controller: "todo_items_controller1"
    }).otherwise({
      redirectTo: "/"
    });
    return $locationProvider.html5Mode(true);
  }
]);

TodoApp.controller("todo_items_controller1", [
  "$scope", "$http", function($scope, $http) {
    $scope.todo_items = [];
    $scope.getItems = function() {
      return $http.get("/todo_items.json").success(function(data) {
        return $scope.todo_items = data;
      });
    };
    $scope.getItems();
    $scope.addItem = function() {
      $scope.newItem.completed = false;
      return $http.post("/todo_items.json", $scope.newItem).success(function(data) {
        $scope.newItem = {};
        return $scope.todo_items.push(data);
      });
    };
    $scope.deleteItem = function(todo_item) {
      var conf;
      conf = confirm("Are you sure?");
      if (conf) {
        return $http["delete"]("/todo_items/" + todo_item.id + ".json").success(function(data) {
          console.log("todo_item", todo_item);
          return $scope.todo_items.splice($scope.todo_items.indexOf(todo_item), 1);
        });
      }
    };
    $scope.editItem = function(todo_item) {
      this.checked = false;
      return $http.put("/todo_items/" + todo_item.id + ".json", todo_item).success(function(data) {
        return console.log(data);
      });
    };
    return $scope.completedItem = function(todo_item) {
      todo_item.completed = !todo_item.completed;
      console.log(todo_item);
      return $http.put("/todo_items/" + todo_item.id + ".json", todo_item).success(function(data) {});
    };
  }
]);

TodoApp.config([
  "$httpProvider", function($httpProvider) {
    return $httpProvider.defaults.headers.common['X-CSRF-Token'] = $('meta[name=csrf-token]').attr('content');
  }
]);
